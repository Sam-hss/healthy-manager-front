{"remainingRequest":"D:\\idea_workspace\\healthy-manager-front\\node_modules\\babel-loader\\lib\\index.js!D:\\idea_workspace\\healthy-manager-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\idea_workspace\\healthy-manager-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\idea_workspace\\healthy-manager-front\\src\\views\\system\\Permission.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\idea_workspace\\healthy-manager-front\\src\\views\\system\\Permission.vue","mtime":1618386378383},{"path":"D:\\idea_workspace\\healthy-manager-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616656130250},{"path":"D:\\idea_workspace\\healthy-manager-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1616656090222},{"path":"D:\\idea_workspace\\healthy-manager-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1616656130250},{"path":"D:\\idea_workspace\\healthy-manager-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1616656132299}],"contextDependencies":[],"result":["import _JSON$stringify from \"D:\\\\idea_workspace\\\\healthy-manager-front\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/json/stringify\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:\\\\idea_workspace\\\\healthy-manager-front\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport TreeDetails from './TreeDetails.vue';\nimport CategoryEdit from './CategoryEdit.vue';\nimport Message from '../../components/messages/index';\nexport default {\n  data: function data() {\n    return {\n      data: [],\n      categoryEditTitle: \"\",\n      dialogFormVisible: false,\n      currentEditCategory: null,\n      props: {\n        children: \"children\",\n        label: 'name'\n      },\n      resourceList: [],\n      roleList: [],\n      parentId: 0,\n      currentUser: JSON.parse(localStorage.getItem(\"user\"))\n    };\n  },\n  methods: {\n    handleNodeClick: function handleNodeClick() {},\n    categoryEditChange: function () {\n      var _categoryEditChange = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(data) {\n        var _this = this;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (data.id == null || \"\" === data.id) {\n                  data.parentId = this.parentId;\n                  this.$http.post(\"/resources/add\", data).then(function (res) {\n                    if (res.status === 200) {\n                      Message.success(\"添加资源成功\");\n\n                      _this.init();\n\n                      _this.dialogFormVisible = false;\n                    }\n                  });\n                } else {\n                  this.$http.post(\"/resources/update\", data).then(function (res) {\n                    if (res.status === 200) {\n                      var bindInfo = {\n                        resourceId: data.id,\n                        roleList: data.roleIds\n                      };\n\n                      _this.$http.post(\"/roleResourceBind/saveBind\", bindInfo).then(function (resp) {\n                        if (resp.status === 200) {\n                          Message.success(resp.data);\n\n                          _this.init();\n\n                          _this.dialogFormVisible = false;\n                        }\n                      });\n                    }\n                  });\n                }\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function categoryEditChange(_x) {\n        return _categoryEditChange.apply(this, arguments);\n      }\n\n      return categoryEditChange;\n    }(),\n    deleteCategory: function deleteCategory(data) {\n      var _this2 = this;\n\n      var self = this;\n      self.$confirm('此操作将删除『' + data.name + '』该菜单, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _this2.$http.get(\"/resources/delete/\" + data.id).then(function (res) {\n          if (res.status === 200) {\n            Message.success(res.data);\n            self.init();\n          }\n        });\n      });\n    },\n    addCategory: function addCategory(data) {\n      var self = this;\n      self.parentId = data.id;\n      self.dialogFormVisible = true;\n      self.currentEditCategory = {};\n      self.categoryEditTitle = '添加';\n    },\n    editCategory: function editCategory(data) {\n      var self = this;\n      self.dialogFormVisible = true;\n      self.currentEditCategory = data;\n      console.log(self.currentEditCategory);\n\n      if (data.type === 0) {\n        self.categoryEditTitle = '修改“' + data.name + '”菜单';\n      } else {\n        self.categoryEditTitle = '修改“' + data.name + '”按钮';\n      }\n    },\n    renderContent: function renderContent(h, _ref) {\n      var node = _ref.node;\n      return this.$createElement(TreeDetails, {\n        props: {\n          data: node\n        },\n        on: {\n          'add-category': this.addCategory,\n          'edit-category': this.editCategory,\n          'delete-category': this.deleteCategory\n        }\n      });\n    },\n    init: function () {\n      var _init = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var _this3 = this;\n\n        var user;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                user = JSON.parse(localStorage.getItem(\"user\"));\n                this.$http.get(\"/resources/getMenuByUserId\", {\n                  params: {\n                    \"userId\": user.id,\n                    \"typeId\": \"\"\n                  }\n                }).then(function (res) {\n                  if (res.status === 200) {\n                    _this3.data = res.data;\n\n                    _this3.localStorage.setItem(\"menu\", _JSON$stringify(res.data));\n                  }\n                });\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function init() {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }(),\n    getAllRoles: function getAllRoles() {\n      var _this4 = this;\n\n      this.$http.get(\"/role/all\").then(function (res) {\n        if (res.status === 200) {\n          _this4.roleList = res.data;\n          console.log(_this4.roleList);\n        }\n      });\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n    this.getAllRoles();\n  },\n  components: {\n    CategoryEdit: CategoryEdit\n  }\n};",{"version":3,"sources":["Permission.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div style=\"display: flex;flex-direction: column;align-items: center\">\r\n    <div style=\"margin: 40px 0\"><h1>权限管理</h1></div>\r\n    <el-button size=\"small\"\r\n               type=\"success\" style=\"margin: 20px 0;width: 80%;cursor: default\">\r\n      <!--新&nbsp;&nbsp;&nbsp;&nbsp;增--></el-button>\r\n    <!-- @click=\"addCategory\" -->\r\n    <el-card style=\"width: 80%;margin-bottom: 20px\">\r\n      <el-tree\r\n              :indent=\"38\"\r\n              :props=\"props\"\r\n              :data=\"data\"\r\n              @node-click=\"handleNodeClick\"\r\n              :render-content=\"renderContent\"\r\n              :default-expand-all=\"true\"\r\n      >\r\n      </el-tree>\r\n    </el-card>\r\n    <CategoryEdit\r\n            :title=\"categoryEditTitle\"\r\n            :dialogFormVisible=\"dialogFormVisible\"\r\n            :data=\"currentEditCategory\"\r\n            :roleList=\"roleList\"\r\n            @val-change=\"categoryEditChange\"\r\n            @cancel=\"dialogFormVisible = false\"\r\n    >\r\n    </CategoryEdit>mi\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import TreeDetails from './TreeDetails.vue';\r\n  import CategoryEdit from './CategoryEdit.vue'\r\n  import Message from '../../components/messages/index'\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        data: [],\r\n        categoryEditTitle: \"\",\r\n        dialogFormVisible: false,\r\n        currentEditCategory: null,\r\n        props: {\r\n          children: \"children\",\r\n          label: 'name',\r\n        },\r\n        resourceList: [],\r\n        roleList: [],\r\n        parentId: 0,\r\n        currentUser: JSON.parse(localStorage.getItem(\"user\")),\r\n      };\r\n    },\r\n    methods: {\r\n      handleNodeClick() {\r\n\r\n      },\r\n      async categoryEditChange(data) {\r\n\r\n        if (data.id == null || \"\" === data.id) {\r\n          data.parentId = this.parentId;\r\n          this.$http.post(\"/resources/add\", data).then(res => {\r\n            if (res.status === 200) {\r\n              Message.success(\"添加资源成功\");\r\n              this.init();\r\n              this.dialogFormVisible = false;\r\n            }\r\n          })\r\n        } else {\r\n          this.$http.post(\"/resources/update\", data).then(res => {\r\n            if (res.status === 200) {\r\n              let bindInfo = {\r\n                resourceId: data.id,\r\n                roleList: data.roleIds\r\n              };\r\n              this.$http.post(\"/roleResourceBind/saveBind\", bindInfo).then(resp => {\r\n                if (resp.status === 200) {\r\n                  Message.success(resp.data);\r\n                  this.init();\r\n                  this.dialogFormVisible = false;\r\n                }\r\n              })\r\n            }\r\n          })\r\n        }\r\n      },\r\n      deleteCategory(data) {\r\n        let self = this;\r\n        self.$confirm('此操作将删除『' + data.name + '』该菜单, 是否继续?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          this.$http.get(\"/resources/delete/\" + data.id).then(res => {\r\n            if (res.status === 200) {\r\n              Message.success(res.data);\r\n              self.init();\r\n            }\r\n          })\r\n        });\r\n\r\n      },\r\n      addCategory(data) {\r\n        let self = this;\r\n        self.parentId = data.id;\r\n        self.dialogFormVisible = true;\r\n        self.currentEditCategory = {};\r\n        self.categoryEditTitle = '添加';\r\n      },\r\n      editCategory(data) {\r\n        let self = this;\r\n        self.dialogFormVisible = true;\r\n        self.currentEditCategory = data;\r\n        console.log(self.currentEditCategory);\r\n        if (data.type === 0) {\r\n          self.categoryEditTitle = '修改“' + data.name + '”菜单';\r\n        } else {\r\n          self.categoryEditTitle = '修改“' + data.name + '”按钮';\r\n        }\r\n      },\r\n      renderContent(h, {node}) {\r\n        return this.$createElement(TreeDetails, {\r\n          props: {data: node}, on: {\r\n            'add-category': this.addCategory,\r\n            'edit-category': this.editCategory,\r\n            'delete-category': this.deleteCategory,\r\n          }\r\n        });\r\n      },\r\n\r\n      async init() {\r\n        let user = JSON.parse(localStorage.getItem(\"user\"));\r\n        this.$http.get(\"/resources/getMenuByUserId\", {params: {\"userId\": user.id, \"typeId\": \"\"}}).then(res => {\r\n          if (res.status === 200) {\r\n            this.data = res.data;\r\n            this.localStorage.setItem(\"menu\", JSON.stringify(res.data));\r\n          }\r\n        })\r\n      },\r\n      getAllRoles() {\r\n        this.$http.get(\"/role/all\").then(res => {\r\n          if (res.status === 200) {\r\n            this.roleList = res.data;\r\n            console.log(this.roleList)\r\n          }\r\n        })\r\n      }\r\n    },\r\n    mounted: function () {\r\n      this.init();\r\n      this.getAllRoles();\r\n    },\r\n    components: {\r\n      CategoryEdit\r\n    }\r\n  };\r\n</script>\r\n<style lang=\"less\">\r\n  .el-tree-node__content {\r\n    height: 40px;\r\n    line-height: 40px;\r\n  }\r\n</style>\r\n\r\n\r\n"],"sourceRoot":"src/views/system"}]}